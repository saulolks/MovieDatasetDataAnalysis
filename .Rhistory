geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label=title)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label="title")) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
title
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label=title)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label=title)) +
geom_text(aes(label=title))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title.y))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(data=aux_movies,aes(label=title.y))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(data=aux_movies, aes(label=title.y))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title.y))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_line() +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot() +
geom_line(rate_revenue, aes(x=vote_average, y=revenue)) +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_text(aes(label=title))+
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.y)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_point(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
index = which(duplicated(aux_movies$vote_average))
aux_movies <- aux_movies[-index,]
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y)) +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y), colour="green") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label=title.y)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y), colour="green") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x, label=title.y)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="green") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y), colour="green") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
geom_text(aes(label=title.y), colour="blue") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
install.packages("ggrepel")
# Relação avaliação/arrecadação ------------------------------------------------
library(ggrepel)
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
aux_movies <- movies_root %>% select(title, vote_average, revenue, vote_count, release_year) %>%
filter(vote_count>1000)
aux_movies$revenue <- as.integer(aux$revenue/1000000)
aux_movies$revenue_2 <- as.integer(aux_movies$revenue/10) * 10
aux_movies <- merge(x=rate_revenue, y=aux_movies, by=c("vote_average", "revenue_2"))
index = which(duplicated(aux_movies$vote_average))
aux_movies <- aux_movies[-index,]
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
names_w_years <- paste(aux_movies$title.y, " (", aux_movies$release_year, ")", sep="")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
title.y
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point() +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=title.y),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=revenue.x, y=vote_average)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=revenue, y=vote_average)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
View(movies_root)
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.y)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue_2)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.y)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue_2)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
ggplot(data=aux_movies, mapping = aes(x=vote_average, y=revenue.x)) +
geom_point(color="blue", size=3) +
geom_line(data=rate_revenue, mapping=aes(x=vote_average, y=revenue)) +
#geom_text(aes(label=title.y), colour="blue") +
geom_label_repel(aes(label=names_w_years),
box.padding=0.35,
point.padding=0.5,
segment.color="grey50") +
xlab("Rating") +
ylab("Average Revenue (in millions)")
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n())
# Filmes estrangeiros com mais arrecadação -------------------------------------
international_movies <- movies_root %>%
filter(original_language != "en")
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n())
View(language_group)
language_group_year <- international_movies %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
View(language_group_year)
language_group <- international_movies %>%
filter(original_language %in% top_5) %>%
group_by(original_language) %>%
summarise(count=n())
language_group_year <- international_movies %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
top_5 <- international_revenues$original_languages[1:5]
language_group <- international_movies %>%
filter(original_language %in% top_5) %>%
group_by(original_language) %>%
summarise(count=n())
language_group_year <- international_movies %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
top_5 <- international_revenues$original_languages[1:5]
international_revenues <- international_movies %>%
select(title, release_year, revenue,
original_language, vote_average, vote_count) %>%
arrange(desc(revenue))
top_5 <- language_group$original_languages[1:5]
top_5 <- language_group$original_language[1:5]
language_group <- international_movies %>%
filter(original_language %in% top_5) %>%
group_by(original_language) %>%
summarise(count=n())
top_5 <- language_group$original_language[1:5]
# Filmes estrangeiros com mais arrecadação -------------------------------------
international_movies <- movies_root %>%
filter(original_language != "en")
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n())
top_5 <- language_group$original_language[1:5]
language_group_year <- international_movies %>%
filter(original_language %in% top_5) %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
top_5 <- as.character(language_group$original_language)[1:5]
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n()) %>%
arrange(desc(count))
top_5 <- as.character(language_group$original_language)[1:5]
language_group_year <- international_movies %>%
filter(original_language %in% top_5) %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
ggplot(data=fr, aes=(x=fr$release_year, y=fr$vote_average)) +
geom_line()
fr <- filter(language_group_year, original_language=="fr")
it <- filter(language_group_year, original_language=="it")
ja <- filter(language_group_year, original_language=="ja")
de <- filter(language_group_year, original_language=="de")
es <- filter(language_group_year, original_language=="es")
ggplot(data=fr, aes=(x=fr$release_year, y=fr$vote_average)) +
geom_line()
ggplot(data=fr, aes(x=release_year, y=vote_average)) +
geom_line()
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line()
language_group_year <- international_movies %>%
filter(original_language %in% top_5, vote_count>500) %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
fr <- filter(language_group_year, original_language=="fr")
it <- filter(language_group_year, original_language=="it")
ja <- filter(language_group_year, original_language=="ja")
de <- filter(language_group_year, original_language=="de")
es <- filter(language_group_year, original_language=="es")
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line()
language_group_year <- international_movies %>%
filter(original_language %in% top_5, vote_count>100) %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
fr <- filter(language_group_year, original_language=="fr")
it <- filter(language_group_year, original_language=="it")
ja <- filter(language_group_year, original_language=="ja")
de <- filter(language_group_year, original_language=="de")
es <- filter(language_group_year, original_language=="es")
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line()
View(fr)
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line() +
coord_cartesian(ylim=c(3,9))
fr <- filter(language_group_year, original_language=="fr", release_year>1960)
it <- filter(language_group_year, original_language=="it", release_year>1960)
ja <- filter(language_group_year, original_language=="ja", release_year>1960)
de <- filter(language_group_year, original_language=="de", release_year>1960)
es <- filter(language_group_year, original_language=="es", release_year>1960)
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line() +
coord_cartesian(ylim=c(3,9))
View(it)
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line() +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating)) +
geom_line(data=ja, aes(x=release_year, y=rating)) +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating))
ggplot(data=fr, aes(x=release_year, y=rating), colour="blue") +
geom_line() +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating)) +
geom_line(data=ja, aes(x=release_year, y=rating)) +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating))
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating), color="green") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange")
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating), color="green", fill="Italy") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange")
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating, fill="Italy"), color="green") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange")
fr <- filter(language_group_year, original_language=="fr", release_year>2000)
it <- filter(language_group_year, original_language=="it", release_year>2000)
ja <- filter(language_group_year, original_language=="ja", release_year>2000)
de <- filter(language_group_year, original_language=="de", release_year>2000)
es <- filter(language_group_year, original_language=="es", release_year>2000)
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating), color="green") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange")
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating), color="green") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange") +
scale_color_manual(values = c("darkred", "steelblue"))
ggplot(data=fr, aes(x=release_year, y=rating)) +
geom_line(color="blue") +
coord_cartesian(ylim=c(3,9)) +
geom_line(data=it, aes(x=release_year, y=rating), color="green") +
geom_line(data=ja, aes(x=release_year, y=rating), color="red") +
geom_line(data=de, aes(x=release_year, y=rating)) +
geom_line(data=es, aes(x=release_year, y=rating), color="orange") +
scale_color_manual()
ggplot(data=language_group_year, aes(x=release_year, y=rating)) +
geom_line(aes(color=original_language, linetype=original_language)) +
coord_cartesian(ylim=c(3,9))
language_group_year <- international_movies %>%
filter(original_language %in% top_5, vote_count>100, release_year>2000) %>%
group_by(release_year, original_language) %>%
summarise(rating=mean(vote_average))
ggplot(data=language_group_year, aes(x=release_year, y=rating)) +
geom_line(aes(color=original_language, linetype=original_language)) +
coord_cartesian(ylim=c(3,9))
# Língua estrangeira com melhor avaliação ao longo dos anos --------------------
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n()) %>%
arrange(desc(count))
top_5 <- as.character(language_group$original_language)[1:5]
# Língua estrangeira com melhor avaliação ao longo dos anos --------------------
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(revenue=sum(revenue)) %>%
arrange(desc(revenue))
# Língua estrangeira com melhor avaliação ao longo dos anos --------------------
language_group <- international_movies %>%
group_by(original_language) %>%
summarise(count=n()) %>%
arrange(desc(count))
top_5 <- as.character(language_group$original_language)[1:5]
language_group_year <- international_movies %>%
filter(original_language %in% top_5, vote_count>100, release_year>2000) %>%
group_by(release_year, original_language) %>%
summarise(revenue=sum(revenue))
language_revenue_year <- international_movies %>%
filter(original_language %in% top_5, vote_count>100, release_year>2000) %>%
group_by(release_year, original_language) %>%
summarise(revenue=sum(revenue))
ggplot(data=language_group_year, aes(x=release_year, y=revenue)) +
geom_line(aes(color=original_language, linetype=original_language))
language_revenue_year$revenue <- language_revenue_year$revenue/1000000
ggplot(data=language_group_year, aes(x=release_year, y=revenue)) +
geom_line(aes(color=original_language, linetype=original_language))
ggplot(data=language_revenue_year, aes(x=release_year, y=revenue)) +
geom_line(aes(color=original_language, linetype=original_language))
ggplot(data=language_revenue_year, aes(x=release_year, y=revenue)) +
geom_bar(aes(color=original_language, linetype=original_language))
ggplot(data=language_revenue_year, aes(x=release_year, y=revenue)) +
geom_line(aes(color=original_language, linetype=original_language))
